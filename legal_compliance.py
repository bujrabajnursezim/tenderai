import re

# ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
# –ü–†–ê–í–û–í–´–ï –ü–†–ê–í–ò–õ–ê ‚Äî –ó–∞–∫–æ–Ω –†–ö –æ –≥–æ—Å–∑–∞–∫—É–ø–∫–∞—Ö
# ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

LAW_REF = "–ó–∞–∫–æ–Ω –†–ö ‚Ññ 106-VIII ¬´–û –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞–∫—É–ø–∫–∞—Ö¬ª (2024)"

LEGAL_RULES = [
    {
        "id": "brand",
        "article": f"{LAW_REF} ‚Äî –ó–∞–ø—Ä–µ—Ç –Ω–∞ —É–∫–∞–∑–∞–Ω–∏–µ –±—Ä–µ–Ω–¥–∞",
        "violation_text": "–£–∫–∞–∑–∞–Ω –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –±—Ä–µ–Ω–¥/–º–∞—Ä–∫–∞ ‚Äî –∑–∞–∫–æ–Ω –∑–∞–ø—Ä–µ—â–∞–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –º–∞—Ä–∫–∏ –∏ –º–æ–¥–µ–ª–∏ –ø—Ä–∏ –≥–æ—Å–∑–∞–∫—É–ø–∫–∞—Ö",
        "ok_text": "–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –±—Ä–µ–Ω–¥—ã –Ω–µ —É–∫–∞–∑–∞–Ω—ã",
        "patterns": [
            r"\b—Å—Ç—Ä–æ–≥–æ\s+\w+",
            r"\b–∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ\s+\w+",
            r"\b—Ç–æ–ª—å–∫–æ\s+(–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å|–±—Ä–µ–Ω–¥|–º–∞—Ä–∫)",
            r"\b(dell|hp|apple|samsung|lenovo|cisco|siemens|xerox|canon|toyota|bmw|mercedes)\b",
        ],
        "severity": "high"
    },
    {
        "id": "article_number",
        "article": f"{LAW_REF} ‚Äî –ó–∞–ø—Ä–µ—Ç –Ω–∞ —É–∫–∞–∑–∞–Ω–∏–µ –∞—Ä—Ç–∏–∫—É–ª–∞",
        "violation_text": "–£–∫–∞–∑–∞–Ω –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∞—Ä—Ç–∏–∫—É–ª —Ç–æ–≤–∞—Ä–∞ ‚Äî —Å—É–∂–∞–µ—Ç –∫—Ä—É–≥ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤",
        "ok_text": "–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∞—Ä—Ç–∏–∫—É–ª—ã –Ω–µ —É–∫–∞–∑–∞–Ω—ã",
        "patterns": [
            r"\b–∞—Ä—Ç–∏–∫—É–ª\s*[:\s]\s*\w+",
            r"\b–∞—Ä—Ç\.\s*\w+",
            r"\b–º–æ–¥–µ–ª—å\s*[:\s]\s*[A-Z0-9\-]{4,}",
            r"\b[A-Z]{2,}\d{4,}[A-Z0-9\-]*\b",
        ],
        "severity": "medium"
    },
    {
        "id": "deadline_short",
        "article": f"{LAW_REF} ‚Äî –ù–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π —Å—Ä–æ–∫ –ø–æ—Å—Ç–∞–≤–∫–∏",
        "violation_text": "–°—Ä–æ–∫ –ø–æ—Å—Ç–∞–≤–∫–∏ 1-2 –¥–Ω—è ‚Äî –Ω–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—é",
        "ok_text": "–°—Ä–æ–∫ –ø–æ—Å—Ç–∞–≤–∫–∏ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –Ω–æ—Ä–º—ã",
        "patterns": [
            r"–≤ —Ç–µ—á–µ–Ω–∏[–µ–∏]\s*1\s*(—Ä–∞–±–æ—á|–∫–∞–ª–µ–Ω–¥–∞—Ä)\w+\s*–¥–Ω",
            r"–≤ —Ç–µ—á–µ–Ω–∏[–µ–∏]\s*2\s*(—Ä–∞–±–æ—á|–∫–∞–ª–µ–Ω–¥–∞—Ä)\w+\s*–¥–Ω",
            r"–ø–æ—Å—Ç–∞–≤–∫–∞\s*–∑–∞\s*1\s*–¥–µ–Ω—å",
            r"–∂–µ—Ç–∫—ñ–∑—É\s*–º–µ—Ä–∑—ñ–º—ñ\s*1\s*–∫?[“Ø—É]–Ω",
        ],
        "severity": "high"
    },
    {
        "id": "calendar_vs_working",
        "article": f"{LAW_REF} ‚Äî –ö–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–µ vs —Ä–∞–±–æ—á–∏–µ –¥–Ω–∏",
        "violation_text": "–£–∫–∞–∑–∞–Ω—ã –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–µ –¥–Ω–∏ –≤–º–µ—Å—Ç–æ —Ä–∞–±–æ—á–∏—Ö ‚Äî –∑–∞–∫–æ–Ω —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å—Ä–æ–∫–∏ –≤ —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è—Ö",
        "ok_text": "–§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ —Å—Ä–æ–∫–æ–≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞",
        "patterns": [
            r"–≤ —Ç–µ—á–µ–Ω–∏[–µ–∏]\s*[1-5]\s*–∫–∞–ª–µ–Ω–¥–∞—Ä\w+\s*–¥–Ω",
        ],
        "severity": "medium"
    },
    {
        "id": "authorized_dealer",
        "article": f"{LAW_REF} ‚Äî –ó–∞–ø—Ä–µ—Ç –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π",
        "violation_text": "–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ/—É–ø–æ–ª–Ω–æ–º–æ—á–µ–Ω–Ω–æ–≥–æ –¥–∏–ª–µ—Ä–∞ ‚Äî –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—é",
        "ok_text": "–î–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ –ø–æ—Å—Ç–∞–≤—â–∏–∫—É –Ω–µ—Ç",
        "patterns": [
            r"–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω\w+\s+(–¥–∏–ª–µ—Ä|–ø–∞—Ä—Ç–Ω–µ—Ä|–ø–æ—Å—Ç–∞–≤—â–∏–∫)",
            r"—É–ø–æ–ª–Ω–æ–º–æ—á–µ–Ω–Ω\w+\s+(–¥–∏–ª–µ—Ä|–ø–∞—Ä—Ç–Ω–µ—Ä|–ø–æ—Å—Ç–∞–≤—â–∏–∫)",
            r"–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω\w+\s+(–¥–∏–ª–µ—Ä|–∏–º–ø–æ—Ä—Ç–µ—Ä|–¥–∏—Å—Ç—Ä–∏–±—å—é—Ç–æ—Ä)",
            r"”©–∫—ñ–ª–µ—Ç—Ç—ñ\s+–¥–∏–ª–µ—Ä",
        ],
        "severity": "high"
    },
    {
        "id": "experience",
        "article": f"{LAW_REF} ‚Äî –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è",
        "violation_text": "–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –æ–ø—ã—Ç–∞ —Ä–∞–±–æ—Ç—ã –±–æ–ª–µ–µ 5 –ª–µ—Ç ‚Äî –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–±—ã—Ç–æ—á–Ω—ã–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º",
        "ok_text": "–ö–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤ –Ω–æ—Ä–º–µ",
        "patterns": [
            r"–æ–ø—ã—Ç\s*—Ä–∞–±–æ—Ç—ã\s*(–Ω–µ –º–µ–Ω–µ–µ|–æ—Ç)\s*(6|7|8|9|10)\s*–ª–µ—Ç",
            r"—Ç”ô–∂—ñ—Ä–∏–±–µ\s*(–∫–µ–º—ñ–Ω–¥–µ)?\s*(6|7|8|9|10)\s*–∂—ã–ª",
        ],
        "severity": "medium"
    },
]

# ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
# –û–°–ù–û–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø
# ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

def check_legal_compliance(text):
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–µ–∫—Å—Ç —Ç–µ–Ω–¥–µ—Ä–∞ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤—É –†–ö –æ –≥–æ—Å–∑–∞–∫—É–ø–∫–∞—Ö.
    
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π:
    {
        "status": "violation" | "ok",
        "article": "–°—Ç–∞—Ç—å—è XX",
        "message": "–û–ø–∏—Å–∞–Ω–∏–µ",
        "found": "–ù–∞–π–¥–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç" (—Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞—Ä—É—à–µ–Ω–∏–∏),
        "severity": "high" | "medium"
    }
    """
    results = []
    text_lower = text.lower()
    
    for rule in LEGAL_RULES:
        found_match = None
        
        for pattern in rule["patterns"]:
            match = re.search(pattern, text_lower, re.IGNORECASE)
            if match:
                # –ë–µ—Ä—ë–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤–æ–∫—Ä—É–≥ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ
                start = max(0, match.start() - 20)
                end = min(len(text), match.end() + 20)
                found_match = "..." + text[start:end].strip() + "..."
                break
        
        if found_match:
            results.append({
                "status": "violation",
                "article": rule["article"],
                "message": rule["violation_text"],
                "found": found_match,
                "severity": rule["severity"]
            })
        else:
            results.append({
                "status": "ok",
                "article": rule["article"],
                "message": rule["ok_text"],
                "found": None,
                "severity": rule["severity"]
            })
    
    return results


def get_legal_summary(compliance_results):
    """
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ –ø—Ä–∞–≤–æ–≤–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.
    """
    violations = [r for r in compliance_results if r["status"] == "violation"]
    high = [r for r in violations if r["severity"] == "high"]
    medium = [r for r in violations if r["severity"] == "medium"]
    
    if not violations:
        return {
            "level": "clean",
            "text": "–Ø–≤–Ω—ã—Ö –ø—Ä–∞–≤–æ–≤—ã—Ö –Ω–∞—Ä—É—à–µ–Ω–∏–π –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ",
            "count": 0
        }
    elif high:
        return {
            "level": "critical",
            "text": f"–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ {len(violations)} –≤–æ–∑–º–æ–∂–Ω—ã—Ö –Ω–∞—Ä—É—à–µ–Ω–∏–π ({len(high)} –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö)",
            "count": len(violations)
        }
    else:
        return {
            "level": "warning",
            "text": f"–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ {len(violations)} –≤–æ–∑–º–æ–∂–Ω—ã—Ö –Ω–∞—Ä—É—à–µ–Ω–∏–π",
            "count": len(violations)
        }


# ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
# –¢–ï–°–¢
# ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

if __name__ == "__main__":
    test_text = """
    –ù–æ—É—Ç–±—É–∫ —Å—Ç—Ä–æ–≥–æ Dell XPS 13 –∞—Ä—Ç–∏–∫—É–ª 9310-2021.
    –ü–æ—Å—Ç–∞–≤–∫–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ 1 —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è.
    –ò—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –¥–∏–ª–µ—Ä Dell Technologies —É—Ä–æ–≤–Ω—è Gold.
    –û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å —Å—Ç—Ä–æ–≥–æ Hynix DDR4 32GB –∞—Ä—Ç–∏–∫—É–ª HMA82GR7CJR4N.
    """
    
    results = check_legal_compliance(test_text)
    summary = get_legal_summary(results)
    
    print(f"\n{summary['text']}\n")
    for r in results:
        icon = "üî¥" if r["status"] == "violation" else "‚úÖ"
        print(f"{icon} {r['article']}")
        print(f"   {r['message']}")
        if r["found"]:
            print(f"   –ù–∞–π–¥–µ–Ω–æ: {r['found']}")
        print()
